<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>奖品编辑</title>
    <link href="http://resali.huobanplus.com/cdn/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <link href="http://resali.huobanplus.com/cdn/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">
    <!-- Morris -->
    <link href="http://resali.huobanplus.com/cdn/hotui/css/plugins/morris/morris-0.4.3.min.css" rel="stylesheet">
    <link href="http://resali.huobanplus.com/cdn/hotui/css/animate.min.css" rel="stylesheet">
    <link href="http://resali.huobanplus.com/cdn/hotui/css/style.min-1.0.7.css" rel="stylesheet">
    <!--checkbox-->
    <link href="http://resali.huobanplus.com/cdn/hotui/css/plugins/awesome-bootstrap-checkbox/awesome-bootstrap-checkbox.css"
          rel="stylesheet">
    <!--datetimepick-->
    <link href="http://resali.huobanplus.com/cdn/hotui/css/plugins/datetimepick/daterangepicker.css" rel="stylesheet"/>
</head>

<body class="gray-bg">
<div class="wrapper wrapper-content">
    <div class="ibox float-e-margins">
        <div class="ibox-content">
            <form method="post" th:action="@{/mall/prize/save}" class="form-horizontal" id="editSavePrize">
                <input type="hidden" th:value="${actPrize.activity.actId}" name="actId">
                <input type="hidden" th:value="${actPrize.prizeCount}" name="prizeCount">
                <input type="hidden" th:value="${actPrize.prizeId}" name="prizeId">
                <div class="form-group">
                    <label class="col-sm-3 control-label">奖品名称:</label>
                    <div class="col-sm-3">
                        <input type="text" placeholder="奖品名称" class="form-control" name="prizeName"
                               th:value="${actPrize.prizeName}">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">奖品类型:</label>
                    <div class="col-sm-2">
                        <select class="form-control input" name="prizeType" id="prizeType">
                            <option selected="selected" value="0">谢谢惠顾</option>
                            <option selected="selected" value="1">奖品</option>
                        </select>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">上传图片</label>
                    <div class="col-sm-3">
                        <input type="hidden" name="prizeImageUrl" th:value="${actPrize.prizeImageUrl}"/>
                        <input type="file" id="uploadFile" name="btnFile" readonly="readonly" class="form-control">
                        <button class="btn btn-success" id="uploadImage" type="button"
                                onclick="prizeEditHandler.uploadFile()">上传图片
                        </button>
                        <span class="help-block"><i class="fa fa-info-circle"></i>推荐尺寸：200*200</span>
                        <img class="imageShow" src="../../resources/images/infoBg.png"
                             th:src="${actPrize.prizeImageUrl}" style="width:200px;height:200px;"/>
                    </div>
                </div>
                <div class="hr-line-dashed"></div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">奖品数量:</label>
                    <div class="col-sm-3">
                        <input type="text" placeholder="奖品数量" class="form-control" name="remainCount"
                               th:value="${actPrize.remainCount}">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">中奖概率:</label>
                    <div class="col-sm-3">
                        <input type="text" placeholder="中奖概率" th:value="${actPrize.winRate}" name="winRate"
                               class="form-control">
                    </div>
                </div>
                <div class="form-group">
                    <label class="col-sm-3 control-label">排序字段:</label>
                    <div class="col-sm-3">
                        <input type="text" placeholder="排序字段" class="form-control" th:value="${actPrize.sort}"
                               name="sort">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-sm-8 col-sm-offset-5">
                        <button class="btn btn-primary btn-success" type="button" onclick="prizeEditHandler.screen()">
                            保存
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>

<!--基础框架js-->
<script src="http://resali.huobanplus.com/cdn/jquery/2.2.4/jquery.min.js"></script>
<script src="../../resources/js/plugins/hot/bootstrap.hot.extra-utils.js"
        th:src="@{/resources/js/plugins/hot/bootstrap.hot.extra-utils.js}"></script>
<script src="http://resali.huobanplus.com/cdn/bootstrap/3.3.5/bootstrap.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/hotui/js/content.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/hotui/js/plugins/prettyfile/bootstrap-prettyfile.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-validation/1.15.0/jquery.validate.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-validation/1.15.0/additional-methods.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/jquery-validation/1.15.0/localization/messages_zh.min.js"></script>
<script src="http://resali.huobanplus.com/cdn/hotui/js/plugins/hot/bootstrap.hot.extra-validate.js"></script>
<script src="http://resali.huobanplus.com/cdn/hotui/js/plugins/SearchableSelect/jquery.searchableSelect.js"></script>
<script src="http://resali.huobanplus.com/cdn/hotui/js/plugins/hot/bootstrap.hot.extra-utils-1.0.1.js"></script>
<script src="http://resali.huobanplus.com/cdn/hotui/js/plugins/hot/bootstrap.hot.extra-init.js"></script>
<script src="http://resali.huobanplus.com/cdn/hotui/js/plugins/ajaxfileupload/ajaxfileupload.js"></script>

<script type="text/javascript">
    var prizeType = [[${actPrize.prizeType}]];
    if (prizeType) {
        prizeType = 1;
    } else {
        prizeType = 0;
    }
    $("#prizeType").val(prizeType);
    var prizeEditHandler = {
        uploadFile: function () {
            hot.loading.show();
            $.ajaxFileUpload({
                url: "/mall/common/upload",
                secureuri: false,// 一般设置为false
                fileElementId: "uploadFile",// 文件上传表单的id <input type="file" id="fileUpload" name="file" />
                dataType: 'json',// 返回值类型 一般设置为json
                type: "post",
                success: function (data) // 服务器成功响应处理函数
                {
                    if (data.code == 200) {
                        $('#imageShow').attr('src', data.fileUrl);
                        $("input:hidden[name='prizeImageUrl']").val(data.fileUri);
                        hot.tip.success(data.msg);
                    } else {
                        hot.loading.hide();
                    }
                },
                error: function ()// 服务器响应失败处理函数
                {
                    hot.tip.error("服务器异常,请稍后再试");
                }
            })
        },
        screen: function () {
            $("#editSavePrize").submit();
        }
    }
</script>
</body>

</html>
